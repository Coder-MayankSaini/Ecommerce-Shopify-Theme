{% comment %} Random Logic based on Product ID - Must match snippets/fake-reviews.liquid {% endcomment %}
{% assign product_id_num = product.id | default: 123456789 %}
{% assign random_seed = product_id_num | modulo: 1000 %}

{% comment %} Calculate Rating {% endcomment %}
{% assign rating_mod = random_seed | modulo: 6 %}
{% case rating_mod %}
  {% when 0 %}{% assign rating_score = 4.8 %}
  {% when 1 %}{% assign rating_score = 4.9 %}
  {% when 2 %}{% assign rating_score = 5.0 %}
  {% when 3 %}{% assign rating_score = 4.7 %}
  {% when 4 %}{% assign rating_score = 4.6 %}
  {% else %}{% assign rating_score = 4.9 %}
{% endcase %}

{% comment %} Calculate Review Count {% endcomment %}
{% assign count_mod = random_seed | modulo: 125 %}
{% assign review_count = 25 | plus: count_mod %}

{%- if rating_score == blank -%}
  {% assign rating_score = 4.8 %}
{%- endif -%}
{%- if review_count == blank -%}
  {% assign review_count = 113 %}
{%- endif -%}

<div style="background: red; color: white; padding: 5px; font-weight: bold;">DEBUG: BADGE SNIPPET LOADED</div>
<div class="custom-rating-badge" style="display: flex; align-items: center; margin-bottom: 15px;">
  <span class="custom-score" style="font-weight: bold; color: #333; font-size: 24px; margin-right: 10px; line-height: 1;">{{ rating_score }}</span>
  <div style="display: flex; flex-direction: column;">
    <span class="custom-stars" style="color: #f3c621; font-size: 14px; line-height: 1; margin-bottom: 2px;">
      {% if rating_score == 5.0 %}★★★★★{% else %}★★★★☆{% endif %}
    </span>
    <span class="custom-text" style="color: #666; font-size: 12px; line-height: 1;">Based on {{ review_count }} reviews</span>
  </div>
</div>